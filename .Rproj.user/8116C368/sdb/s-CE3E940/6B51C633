{
    "contents" : "#########################\n# Házi feladat 4        #\n# Programozás I.        #\n# 2016/17. II. félév    #\n# Mogyorósi Pálma       #\n# 2017.05.01.           #\n#########################\n\n#---------------------------II.01 feladat---------------------------\n# A data mappában találsz egy clinton_trump_tweets.csv nevű fájlt. \n# Ezt hívd be tweets néven. Az eredeti adatfájl innen származik, és \n# Hillary Clinton, valamint Donald Trump 6444 tweetjét tartalmazza 2016. \n# januártól szeptemberig. Ez az adatsor bővítve lett pár új oszloppal. \n# Az új oszlopok a tweetek szövegeinek különbözőképp feldolgozott verzióit \n# tartalmazza, valamint a szövegek legjellemzőbb szentimentjét és emócióját.\n\ntweets <- read.csv2(\"data/clinton_trump_tweets.csv\", stringsAsFactors = F)\n\nView(tweets)\n\n\n#---------------------------II.02 feladat---------------------------\n# Kérd le, hány tweet származik Hillary Clintontól és hány Donald Trumptól! \n# Ezt ábrázold is a fig/sample/tweet1.png alapján, majd mentsd ki a plotot \n# a fig mappába tweet1.png néven!\n\nlibrary(reshape2)\n\nlibrary(ggplot2)\n\nggplot(tweets, aes(x = handle, fill = handle)) + \n  geom_bar() +\n  ggtitle(\"Candidate Tweets\") +\n  xlab(\"\") + ylab(\"Tweet frequency\") +\n  scale_fill_manual(values = c(\"blue\", \"red\"),\n                    labels = c(\"Hillary Clinton\", \"Donald Trump\"),\n                    name = \"Candidate\") +\n  theme(plot.title = element_text(hjust = 0.5),\n        panel.background = element_blank(),\n        axis.text.x = element_blank(),\n        axis.ticks.x = element_blank())\n\nggsave(\"fig/tweet1.png\")\n\n#---------------------------II.03 feladat---------------------------\n# Kérd le, milyen nyelveken írta a tweeteket a két jelölt külön-külön! \n# Nézd meg, hogy a nem angol szövegek valóban nem angolok-e. Ha úgy gondolod, \n# hogy rosszul azonosították a nyelvet, akkor írd át az általad helyesnek váltre. \n# A spanyol nyelvű tweeteket nem kell végigböngészned, mert sok van, de a \n# többit mindenképp nézd meg. Ábrázold a két jelölt által használt nyelvek \n# gyakoriságát a fig/sample/tweet2.png szerint, majd mentsd ki a plotot a fig \n# mappába tweet2.png néven! Az oszlopszínek legyenek \"darkgrey\" és \"cornflowerblue\". \n# (listA nyelvek gyakorisága eltérhet az előző lépés miatt.)\n\ntweets$lang <- as.factor(tweets$lang)\n\n# megnézem külön, hogy Clinton és Trump milyen nyelveket használt\n\nlang_clinton <- subset.data.frame(tweets, tweets$handle == \"HillaryClinton\", \n                                  select = c(handle, text, lang))\n\nlang_trump <- subset.data.frame(tweets, tweets$handle == \"realDonaldTrump\", \n                                select = c(handle, text, lang))\n\n# megnézem, milyen nyelveken tweeteltek\n\nsort(summary(lang_clinton$lang), decreasing = T)\n\nsort(summary(lang_trump$lang), decreasing = T)\n\n# leellenőrzöm a nyelveket és megnézem a sorszámukat\n\ntext_fr <- tweets$text[which(tweets$lang == \"fr\")]\ntext_fr\n\ntext_da <- tweets$text[which(tweets$lang == \"da\")]\ntext_da\n\ntext_tl <- tweets$text[which(tweets$lang == \"tl\")]\ntext_tl\n\ntext_et <- tweets$text[which(tweets$lang == \"et\")]\ntext_et\n\ntext_fi <- tweets$text[which(tweets$lang == \"fi\")]\ntext_fi\n\n# mind angol, megnézem a sorszámukat, átírom angolra\n\nwhich(tweets$lang == \"fr\")\nwhich(tweets$lang == \"da\")\nwhich(tweets$lang == \"tl\")\nwhich(tweets$lang == \"et\")\nwhich(tweets$lang == \"fi\")\n\ntweets[237,11] <- \"en\"\ntweets[6206,11] <- \"en\"\ntweets[6059,11] <- \"en\"\ntweets[6064,11] <- \"en\"\ntweets[6087,11] <- \"en\"\ntweets[5378,11] <- \"en\"\ntweets[5439,11] <- \"en\"\ntweets[5296,11] <- \"en\"\ntweets[5448,11] <- \"en\"\n\n# ggplot\n\nggplot(tweets, aes(x = handle, fill = lang)) + \n  geom_bar(position=\"dodge\") +\n  ggtitle(\"Language of Tweets\") +\n  xlab(\"\") + ylab(\"Tweet frequency\") +\n  scale_fill_manual(values = c(\"darkgray\", \"cornflowerblue\"),\n                    labels = c(\"English\", \"Spain\"),\n                    name = \"Language\") +\n  scale_x_discrete(labels = c(\"Hillary Clinton\", \"Donald Trump\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        panel.background = element_blank(),\n        axis.ticks.x = element_blank())\n\n# kimentés\n\nggsave(\"fig/tweet2.png\")\n\n\n\n#---------------------------II.04 feladat---------------------------\n# Írj egy függvényt, ami a \"Hillary Clinton\" bemenet esetében Hillary Clinton, \n# \"Donald Trump\" bemenet esetében pedig Donald Trump tweetjeit adja ki a \n# retweet_count és a favorite_count összesített értéke alapján csökkenő sorrendben. \n# Legyen egy olyan argumentum is, amivel a kiadott tweetek számát lehet meghatározni.\n# Az argumentumoknak legyen default értéke. A függvény írjon ki hibaüzenetet, \n# ha rossz nevet kap. Ha a kiadott tweetek száma meghaladja a lehetséges tweetek \n# számát, írja ki a tweetek max számát. Mikor a függvény kiadja a tweeteket, \n# írja ki, hogy kinek a tweetjeit írja ki és mennyit. Kérd le a függvénnyel \n# Hillary Clinton első 10, valamint Donald Trump első 15 legtöbbet retweetelt \n# és kedvelt tweetjét.\n\n# a retweet és a favorite összegének csökkenő sorrendje, az első 10 elem kiíratása\n\nsort(tweets$retweet_count + tweets$favorite_count, decreasing = T)[1:10]\n\n# ugyenez Clintonra\n\ntweets2 <- tweets[tweets$handle == \"HillaryClinton\",]\nx <- sort(tweets2$retweet_count + tweets2$favorite_count, decreasing = T)[1:10]\ntweets2$text[(tweets2$retweet_count + tweets2$favorite_count) %in% x]\n\n# a függvények\n\nget_tweets(\"HillaryClinton\")\nget_tweets(\"realDonaldTrump\", 15)\n\n\n#---------------------------III.01 feladat---------------------------\n# A fivethirtyeight package-ben van egy hiphop_cand_lyrics dataset. \n# A fivethirtyeight-en ezt az elemzést készítették az adatokhoz.\n\nlibrary(\"fivethirtyeight\")\n\ndata(hiphop_cand_lyrics)\nhiphop_cand_lyrics\n\n# Készítsd el ggplot2-vel az itt található első 2 ábrát úgy, hogy minél jobban \n# megegyezzen a plotok kinézete. Természetesen nem kell mindennek ugyanolyannak \n# lennie (pl. az oszlopoknak nem kell pontokból állnia), de törekedj a minél \n# nagyobb fokú egyezőségre. Mentsd ki az ábrákat a fig mappába hiphop1.png és \n# hiphop2.png néven!\n\n# a szükséges oszlopok kiszedése\n\nhiphopcand <- table(hiphop_cand_lyrics$candidate, \n                    hiphop_cand_lyrics$album_release_date)\n\n# dataframe-mé alakítom\n\nhiphopcand <- as.data.frame(hiphopcand)\n\n# ggplot - nem jó az order\n\n# más próbálkozások\n# 1. hiphopcand <- hiphopcand[order(-hiphopcand$Freq),] \n# 2. positions <- c(\"TRUMP\", \"CLINTON\", \"BUSH\", \"CHRISTIE\", \"HUCKABEE\", \"SANDERS\", \"CARSON\", \"CRUZ\")\n# 3. install.packages(\"dplyr\")\n# require(\"dplyr\")\n# library(\"dplyr\")\n\n\nggplot(hiphopcand, aes(x = Var2, y = Freq, fill = Var1)) + \n  geom_dotplot(binaxis = \"y\", stackgroups = TRUE, dotsize = 0.5,\n               binwidth = 3, binpositions = \"all\") +\n  ggtitle(\"Every mention of 2016 primary candidates in hip-hop songs\") +\n  xlab(\"\") + ylab(\"\") +\n  scale_fill_manual(values = c(\"#fec075\", \"#94d7fa\", \"#ff8974\", \"#ffd92f\", \"#fccde5\",\n                               \"#66c2a5\", \"#a6d854\", \"#e78ac3\"),\n                    labels = c(\"TRUMP\", \"CLINTON\", \"BUSH\", \"CHRISTIE\",\n                               \"HUCKABEE\", \"SANDERS\", \"CARSON\", \"CRUZ\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.ticks.x = element_blank(),\n        legend.position = \"top\") +\n  scale_x_discrete(labels = c(\"1990\" = \"1990\", \"1995\" = \"'95\",\"2000\" = \"2000\",\n                              \"2005\" = \"'05\",\"2010\" = \"'10\",\"2015\" = \"'15\"),\n                   breaks = c(1990, 1995, 2000, 2005, 2010, 2015))\n\nggsave(\"fig/hiphop1.png\")\n\n##### a második ábrát nem készítettem el ##### \n\n#---------------------------III.02 feladat---------------------------\n# Készíts egy általad értelmesnek tartott ábrát a datasetben található változókat \n# felhasználva! Mentsd ki az ábrát a fig mappába hiphop3.png néven!\n\n# a jelöltek említése témánként\n\nhiphopcand2 <- table(hiphop_cand_lyrics$candidate, \n                     hiphop_cand_lyrics$theme)\n\nhiphopcand2 <- as.data.frame(hiphopcand2)\n\nsummary(hiphopcand2$Var2)\n\nggplot(hiphopcand2, aes(x = Var2, y = Freq, fill = Var1)) + \n  geom_bar(stat = \"identity\", position = \"stack\") +\n  ggtitle(\"Candidates mentioned by themes in hip-hop songs\") +\n  xlab(\"Themes\") + ylab(\"Frequency\") +\n  scale_fill_manual(values = c(\"#fec075\", \"#94d7fa\", \"#ff8974\", \"#ffd92f\", \"#fccde5\",\n                               \"#66c2a5\", \"#a6d854\", \"#e78ac3\"),\n                    labels = c(\"TRUMP\", \"CLINTON\", \"BUSH\", \"CHRISTIE\",\n                               \"HUCKABEE\", \"SANDERS\", \"CARSON\", \"CRUZ\"),\n                    name = \"Candidates\") +\n  scale_x_discrete(labels = c(\"Hotel\", \"Money\", \"Personal\", \"Political\",\n                              \"Power\", \"Sexual\", \"The Apprentice\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        panel.background = element_blank(),\n        axis.ticks.x = element_blank())\n\nggsave(\"fig/hiphop3.png\")\n\n#---------------------------IV.01 feladat---------------------------\n# A clinton_trump_tweets.csv tartalmaz egy text_sentiment és egy text_emotion \n# változót. (...)\n# Hasonlítsd össze Hillary Clinton és Donald Trump tweetjeinek szentimentjeit \n# és emócióit. Vizsgáld meg oszlopdiagrammal és idősoros ábrával az eltéréseket. \n# Nézd meg, hogy statisztikailag szignifikáns-e a különbség a két jelölt \n# szentimentjeinek ill. emócióinak száma között.\n\n# barchartok\n\nggplot(tweets, aes(x = handle, fill = text_sentiment)) +\n  geom_bar(stat = \"count\", position = \"fill\") +\n  ggtitle(\"Candidates' sentiments\") +\n  xlab(\"\") + ylab(\"\") +\n  scale_x_discrete(labels = c(\"Hillary Clinton\", \"Donald Trump\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.ticks.x = element_blank())\n\nggplot(tweets, aes(x = handle, fill = text_emotion)) +\n  geom_bar(stat = \"count\", position = \"fill\") +\n  ggtitle(\"Candidates' emotions\") +\n  xlab(\"\") + ylab(\"\") +\n  scale_x_discrete(labels = c(\"Hillary Clinton\", \"Donald Trump\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        axis.ticks.x = element_blank())\n\n# chi négyzet próbával szignifikáns eltérés vizsgálata\n\nchisq.test(x = tweets$handle, tweets$text_sentiment)\n\nchisq.test(x = tweets$handle, tweets$text_emotion)\n\n# mindkét teszt szerint van szignifikáns különbség\n\n##### az idősoros ábrát nem csináltam meg ##### \n\n\n#---------------------------IV.02 feladat---------------------------\n# Többen feltételezték, hogy Trump tweetjeit (legalább) két különböző ember írja, \n# az androidosokat feltételezhetően Trump, az iphone-osokat pedig valaki más \n# (a mi adatainkban a source_url oszlop tartalmaz erre vonatkozó információkat). \n# Ennek a feltételezésnek a bizonyítására készült egy tök jó szövegelemzés: \n# http://varianceexplained.org/r/trump-tweets/. A szerző itt is összehasonlítja \n# a tweetek szentimentjét (bár más kategóriarendszert használva). \n# Vizsgáld meg vizuálisan, hogy a mi adatunk szerint is különböznek-e a \n# két forrásból származó tweetek szentimentjei ill. emóciói. Nézd meg, \n# hogy statisztikailag szignifikáns-e a különbség.\n\n# dataframe szűrése\n\ntweets_source <- subset.data.frame(tweets, tweets$handle == \"realDonaldTrump\"\n                                   & tweets$source_url != \"NA\",\n                                   c(source_url, text_sentiment, text_emotion))\n\n# iphone/android oszlop létrehozása, feltöltése\n\ntweets_source[\"sources\"] <- NA\n\ntweets_source$sources[tweets_source$source_url == \n                        \"http://twitter.com/download/iphone\"] <- \"iphone\"\n\ntweets_source$sources[tweets_source$source_url == \n                        \"http://twitter.com/download/android\"] <- \"android\"\n\n# chi négyzet próbával szignifikáns eltérés vizsgálata\n\nchisq.test(x = tweets_source$sources, tweets_source$text_sentiment)\n\nchisq.test(x = tweets_source$sources, tweets_source$text_emotion)\n\n# mindkét teszt szerint van szignifikáns különbség\n\n# barchartok\n# valamiért lett NA oszlop is, pedig a tweets_source NA mentes,\n# sajnos nem jöttem rá, miért\n\nggplot(tweets_source, aes(x = sources, fill = text_emotion)) +\n  geom_bar(stat = \"count\", position = \"fill\") +\n  ggtitle(\"Text emotions by sources\") +\n  xlab(\"\") + ylab(\"\") +  \n  scale_fill_manual(values = c(\"#d11141\", \"#daa520\", \"#00b159\", \"#ffc425\",\n                               \"#00aedb\", \"#f37735\", \"#CCCCCC\"),\n                    labels = c(\"Anger\", \"Disgust\", \"Fear\", \"Joy\", \n                               \"Sadness\", \"Surprise\", \"Unknown\"),\n                    name = \"Emotions\") +\n  scale_x_discrete(labels = c(\"Android\", \"Iphone\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        panel.background = element_blank(),\n        axis.ticks.x = element_blank())\n\nggplot(tweets_source, aes(x = sources, fill = text_sentiment)) +\n  geom_bar(stat = \"count\", position = \"fill\") +\n  ggtitle(\"Text sentiments by sources\") +\n  xlab(\"\") + ylab(\"\") +  \n  scale_fill_manual(values = c(\"#ff6f69\", \"#CCCCCC\", \"#96ceb4\"),\n                    labels = c(\"Negative\", \"Neutral\", \"Positive\"),\n                    name = \"Sentiments\") +\n  scale_x_discrete(labels = c(\"Android\", \"Iphone\")) +\n  theme(plot.title = element_text(hjust = 0.5),\n        panel.background = element_blank(),\n        axis.ticks.x = element_blank())\n",
    "created" : 1493932717412.000,
    "dirty" : true,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2303957025",
    "id" : "6B51C633",
    "lastKnownWriteTime" : 1493936639,
    "path" : "D:/ELTE Survey/2. félév/Programozás I/homework-04/src/homework-04.R",
    "project_path" : "src/homework-04.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}